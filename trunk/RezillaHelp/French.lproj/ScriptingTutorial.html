<HTML>
<HEAD>
<TITLE>ScriptingTutorial</TITLE>
<META HTTP-EQUIV="content-type" CONTENT="text/html;charset=macintosh">
<META NAME="generator" CONTENT="Aida Mode">
<META HTTP-EQUIV="Content-Language" CONTENT="fr-FR">
<META NAME="keywords" CONTENT="ressources, AppleScript">
</HEAD>
<BODY>
<P><P><IMG SRC="../Images/rezilla_logo.gif" ALT="Rezilla logo" ALIGN=bottom></P><P><HR><BLOCKQUOTE><P><I> 
Ce document est un didacticiel concernant le support AppleScript de
l'éditeur de ressources <B>Rezilla</B> pour MacOSX. Il explique, au moyen
d'exemples, comment piloter Rezilla en écrivant des scripts dans le langage
AppleScript. Il suppose que le lecteur est déjà familier avec les principes
de base de ce langage. Le présent document correspond à la version 
<B>1.1</B> de Rezilla.
</I></P></BLOCKQUOTE><HR><P><UL>
<LI><A HREF="#M1">Support AppleScript</A>
<UL><LI><A HREF="#M2">Ouvrir et fermer une table de ressources</A></UL>
<UL><LI><A HREF="#M3">Sauvegarder une table de ressources</A></UL>
<UL><LI><A HREF="#M4">Créer une nouvelle table de ressources</A></UL>
<UL><LI><A HREF="#M5">Le modèle d'objets de Rezilla</A></UL>
<UL><UL><LI><A HREF="#M6">Propriétés des documents de ressources</A></UL></UL>
<UL><UL><LI><A HREF="#M7">Propriétés des éditeurs</A></UL></UL>
<UL><UL><LI><A HREF="#M8">Propriétés des fenêtres de ressources</A></UL></UL>
<UL><UL><LI><A HREF="#M9">Propriétés des fenêtres d'édition</A></UL></UL>
<UL><UL><LI><A HREF="#M10">Propriétés des tables</A></UL></UL>
<UL><UL><LI><A HREF="#M11">Propriétés des types</A></UL></UL>
<UL><UL><LI><A HREF="#M12">Propriétés des ressources</A></UL></UL>
<UL><UL><LI><A HREF="#M13">Contenu d'une ressource</A></UL></UL>
<UL><LI><A HREF="#M14">Éditer une ressource</A></UL>
<UL><LI><A HREF="#M15">Modifications dans la fenêtre hexadécimale</A></UL>
<UL><LI><A HREF="#M16">Créer une nouvelle ressource</A></UL>
<UL><LI><A HREF="#M17">Objets de base et propriétés</A></UL>
<UL><UL><LI><A HREF="#M18">Propriétés de l'application</A></UL></UL>
<UL><UL><LI><A HREF="#M19">Propriétés des documents</A></UL></UL>
<UL><UL><LI><A HREF="#M20">Propriétés des fenêtres</A></UL></UL>
<UL><LI><A HREF="#M21">Dénombrement des objets</A></UL>
<UL><LI><A HREF="#M22">Existence d'objets</A></UL>
<UL><LI><A HREF="#M23">Fenêtre d'inspection</A></UL>
<UL><LI><A HREF="#M24">Comparer des tables de ressources</A></UL>
<UL><LI><A HREF="#M25">Exporter une table de ressources</A></UL>
<UL><LI><A HREF="#M26">Importer une table de ressources</A></UL>
<UL><LI><A HREF="#M27">Plugins (éditeurs externes)</A></UL>
<UL><LI><A HREF="#M28">Sélectionneurs de ressources</A></UL>
<LI><A HREF="#M29">Le dictionnaire de Rezilla </A>
</UL><P><H2><A NAME="M1"></A>Support AppleScript</H2><P>Un support complet de scriptabilité dans le langage AppleScript a été
introduit dans <B>Rezilla</B> à partir de la version 1.0.5b. AppleScript
est le langage de scripts d'Apple pour l'automatisation des opérations et
le contrôle externe des applications. <B>Rezilla</B> définit un ensemble
de commandes et de classes afin de manipuler facilement les fichiers de
ressources: elles permettent de simuler la plupart des actions définies par
l'application, c'est-à-dire des commandes disponibles dans les divers
menus.<P>Toutes les commandes expliquées dans ce tutoriel doivent être adressées à
l'application au moyen des instructions <I>tell</I> habituelles, comme par
exemple:
<PRE>
	tell application "Rezilla"
		-- ici viennent les commandes...
	end tell
</PRE><P>Dans la suite de ce document, nous ne répéterons pas à chaque exemple, pour
des raisons de lisibilité, le bloc <I>tell</I> complet mais il est
toujours implicite.<P><H3><A NAME="M2"></A>Ouvrir et fermer une table de ressources</H3><P>On peut ouvrir des fichiers de ressources au moyen de la commande 
<B>open</B>. <P>Pour ouvrir un fichier de ressources nommé <I>somefile.rsrc</I> et situé 
dans le dossier <I>HD:foo:bar:</I>, on utilisera l'instruction suivante:
<PRE>
	open "HD:foo:bar:somefile.rsrc" as alias
</PRE>
De même, pour sélectionner un fichier de ressources et l'ouvrir dans Rezilla, 
il suffit d'écrire:
<PRE>
	set theFile to {choose file}
	open theFile as alias<P></PRE>
Il y a deux paramètres optionnels avec la commande <B>open</B>:
<UL>
	<LI> avec le paramètre <I>readOnly</I>, on peut placer le 
fichier en mode lecture-seule afin de rendre toute modification impossible. 
Par exemple:
<PRE>
	open "HD:foo:bar:somefile.rsrc" as alias with readOnly<P></PRE>
	<LI> avec le paramètre <I>from</I>, on peut restreindre l'ouverture à une 
branche particulière (branche de ressources ou branche de données). Par
défaut, Rezilla regarde dans les deux branches (la branche de données
venant avant la branche de ressources). Par exemple:
<PRE>
	open "HD:foo:bar:somefile.rsrc" as alias from data fork<P></PRE>
Les valeurs possibles pour le paramètre <I>from</I> sont <I>data fork</I>, 
<I>resource fork</I>, ou <I>any fork</I> (qui est la valeur par défaut).<P>	<LI> avec le paramètre <I>createFork</I>, on peut spécifier si l'on
souhaite créer une branche de ressources lorsque le fichier ne possède
aucune branche (à ne pas confondre avec un fichier qui aurait une branche
ne contenant aucune ressource). Ceci n'est possible que si le paramètre 
<I>from</I> n'est pas spécifié ou bien a la valeur <I>any fork</I>.
Par exemple:
<PRE>
	open "HD:foo:bar:file_with_no_fork_at_all" as alias with createFork<P></PRE>
</UL><P>Une table de ressources peut être refermée au moyen de la commande <B>close</B>.
L'argument optionnel <I>saving</I>, permettant de préciser si le document 
doit être sauvegardé avant d'être refermé, est accepté (ses valeurs possibles
sont <I>yes</I>, <I>no</I> ou <I>ask</I>). Par exemple:
<PRE>
	close first map document saving no<P></PRE><P><H3><A NAME="M3"></A>Sauvegarder une table de ressources</H3><P>Les modifications faites dans un document de ressources peuvent être
sauvegardées directement au moyen de la commande <B>save</B>. Deux
paramètres supplémentaires sont définis:
<UL>
	<LI> le paramètre <I>in</I> permet de spécifier le dossier dans lequel on
souhaite créer le nouveau fichier. Ce paramètre est optionnel.
	<LI> le paramètre <I>as</I> permet de spécifier la branche dans laquelle
on souhaite sauvegarder la table de ressources. Les valeurs possibles sont
<I>data fork</I>, <I>resource fork</I> ou <I>same fork</I> (cette dernière
seulement pour la commande <I>Save As</I>). Ce paramètre est optionnel. Il
est ignoré si le paramètre <I>in</I> n'est pas spécifié car, dans ce cas,
Rezilla exécute une simple commande <B>save</B> sur la table de
ressources.
</UL>
Par exemple:
<PRE>
	save document 1 in "HD:foo:bar:otherMap.rsrc" as resource fork<P></PRE><P>Il est aussi possible d'abandonner des modifications faites dans la table
de ressources et de revenir à la dernière version sauvegardée en utilisant
la commande <B>revert</B> comme ceci:
<PRE>
	revert map document 1<P></PRE><P><H3><A NAME="M4"></A>Créer une nouvelle table de ressources</H3><P>On crée une nouvelle table de ressources vide au moyen de la commande <B>make</B>. Cette commande accepte trois paramètres. Les deux premiers sont
obligatoires, l'autre est optionnel:
<UL>
	<LI> le paramètre <I>new</I> indique la classe de l'objet à créer 
(en l'occurence <I>map</I> ou <I>map document</I>)
	<LI> le paramètre <I>in</I> est utilisé pour spécifier le dossier 
contenant le nouveau fichier de ressources 
	<LI> le paramètre <I>with properties</I> est utilisé pour spécifier des 
 propriétés supplémentaires. C'est une liste contenant des paires de type 
clé:valeur. Les clés possibles sont <I>name</I>, <I>fork</I> et <I>readOnly</I>. Ce 
paramètre est optionnel.
</UL><P>Voici un exemple complet:
<PRE>
	-- ask the Finder to make the folder object
	tell application "Finder"
		set theFolder to folder "HD:foo:bar:" as alias
	end tell
	-- create the new map document in this folder
	make new map document in theFolder with properties ¬
		{name:"newmap.rsrc",fork:data fork,readOnly:true}<P></PRE>
On notera que le dossier contenant le nouveau document de ressources doit 
être déclaré dans un bloc
<I>tell</I> adressé au Finder et non pas à Rezilla. Cela provient du fait 
que  le terme <I>folder</I> fait partie du vocabulaire du Finder et non 
pas de celui de Rezilla.<P><H3><A NAME="M5"></A>Le modèle d'objets de Rezilla</H3><P>Il y a essentiellement trois types d'objets dans Rezilla: les documents, 
les fenêtres et les tables de ressources. Le terme de table est utilisé 
pour désigner le contenu entier d'une branche de ressources.<P>Chaque table peut être considérée comme une base de données dont les
éléments sont caractérisés par un type et un numéro d'identification. Le
modèle d'objets de Rezilla utilise une représentation analogue: une
table est un objet qui contient des objets <I>type</I>, et ces objets 
<I>type</I> eux-mêmes contiennent des objets <I>ressource</I> . Un objet
<I>table</I> abstrait est toujours associé dans Rezilla à un document de
ressources.<P>Il y a deux sortes de documents: 
<UL>
	<LI> les documents de ressources correspondent aux fenêtres affichant le 
contenu d'un fichier de ressources ouvert dans Rezilla, avec la liste des 
types et des ressources regroupées sous ce type ;
	<LI> les documents d'éditions (ou simplement éditeurs) correspondent aux
fenêtres d'édition dans lesquelles une ressource particulière se trouve
éditée. Un document d'édition <I>appartient</I> nécessairement à un
document de ressources, de la même manière qu'une ressource <I>appartient</I>
à une table.
</UL><P>Par exemple, on peut obtenir dans un script AppleScript la liste de toutes
les fenêtres, toutes les tables ou tous les documents avec une 
commande comme ceci (le terme <B>get</B> est ici facultatif):
<PRE>
	get windows
	get maps
	get documents
</PRE><P><H4><A NAME="M6"></A>Propriétés des documents de ressources</H4>
Les documents de ressources peuvent être spécifiés par nom ou par indice.
Le nom du document est le nom du fichier à partir duquel il a été ouvert:
il n'est donc pas unique puisque plusieurs fichiers situés dans des
dossiers différents peuvent avoir le même nom. En revanche, l'indice est
unique à un moment donné: c'est l'indice du document parmi tous les autres documents de
ressources ouverts dans Rezilla. L'indice n'est cependant pas permanent: il
peut varier puisque d'autres documents peuvent avoir été refermés.<P>Outre les propriétés partagées par tous les objets de la classe 
<I>documents</I> (voir plus loin), les documents de ressources possèdent
un ensemble de propriétés spécifiques:
<UL>
	<LI> <I>index</I>: l'indice du document parmi les autres documents de 
ressources<P>	<LI> <I>readOnly</I>: le document est-il en lecture seule ?<P>	<LI> <I>window</I>: la fenêtre associée à ce document<P>	<LI> <I>refnum</I>: le numéro de référence de la table de ressources en mémoire (ce 
numéro est unique)<P>	<LI> <I>fork</I>: la branche éditée par ce document (<I>data fork</I> ou 
<I>resource fork</I>, c'est-à-dire branche de données ou branche de 
ressources)<P>	<LI> <I>map</I>: la table de ressources associée à ce document<P>	<LI> <I>file</I>: le fichier sur disque correspondant à ce document de ressources<P>	<LI> <I>format</I>: le format utilisé pour les exports
</UL><P>Par exemple, le script suivant permet de récupérer les valeurs de ces 
propriétés:
<PRE>
	set mapDoc to map document 1
	set a to the name of mapDoc
	set b to the refnum of mapDoc
	set c to the fork of mapDoc
	set d to the index of mapDoc
	set e to the readOnly of mapDoc
	set f to the window of mapDoc
	set g to the file of mapDoc
	set h to the format of mapDoc
	
	{a, b, c, d, e, f, g, h}<P></PRE><P>La propriété <I>format</I> peut être modifiée au moyen de la commande <B>set</B>. 
Les autres sont des propriétés en lecture seulement. Par exemple:
<PRE>
	set the format of map document 1 to html<P></PRE><P><H4><A NAME="M7"></A>Propriétés des éditeurs</H4>
Les éditeurs ont aussi des propriétés qui leur sont propres, en plus des propriétés 
partagées par tous les documents:
<UL>
	<LI> <I>index</I>: l'indice de l'éditeur parmi tous les éditeurs
dépendant d'un même document de ressources<P>	<LI> <I>kind</I>: le type de l'éditeur,  qui peut être <I>hexadecimal</I>, <I>template</I> ou <I>interface</I><P>	<LI> <I>readOnly</I>: ce document est-il en lecture seule ?<P>	<LI> <I>window</I>: la fenêtre associée à ce document<P>	<LI> <I>resource</I>: la ressource éditée par ce document<P>	<LI> <I>owner doc</I>: le document de ressources auquel cet éditeur est attaché
</UL><P>Par exemple, le script suivant permet de récupérer les valeurs de ces
propriétés (en supposant qu'un éditeur est effectivement ouvert):
<PRE>
	set theEd to editor 1 of map document 1
	set a to the index of theEd
	set b to the kind of theEd
	set c to the readOnly of theEd
	set d to the window of theEd
	set e to the resource of theEd
	set f to the owner doc of theEd
	
	{a, b, c, d, e, f}<P></PRE><P>Toutes ces propriétés sont des propriétés en lecture seulement. Elles ne
peuvent être modifiées au moyen de la commande <B>set</B>.<P><H4><A NAME="M8"></A>Propriétés des fenêtres de ressources</H4>
La classe <I>map window</I> désigne les fenêtres affichant le contenu des
documents de ressources. Elles possèdent seulement deux propriétés
particulières qui correspondent aux valeurs des champs situés au bas de ces
fenêtres:
<UL> 
	<LI> <I>types count</I>: nombre de types contenus dans cette table<P>	<LI> <I>resources count</I>: nombre total de ressources
</UL><P>On pourra obtenir ces valeurs comme ceci:
<PRE>
	set mapWin to map window 1
	set a to the types count of mapWin
	set b to the resources count of mapWin
	{a, b}<P></PRE>
Ce sont des propriétés en lecture seulement. <P><H4><A NAME="M9"></A>Propriétés des fenêtres d'édition</H4>
La classe <I>editing window</I> représente les fenêtres affichées par les 
éditeurs. Elles ont une seule propriété spécifique,
<I>kind</I>, qui indique le type de l'éditeur correspondant (c'est-à-dire
 <I>hexadecimal</I>, <I>template</I> ou <I>interface</I>).<P>Par exemple:
<PRE>
	set editWin to editing window 1
	get the kind of editWin<P></PRE>
C'est une propriété en lecture seulement.  <P>Par commodité, il est possible de désigner les fenêtres d'édition
directement comme des éléments d'un document principal. 
Ainsi, les raccourcis suivants sont autorisés:
<PRE>
	get editing window 1 of map document 1
</PRE>
au lieu de 
<PRE>
	get window of editor 1 of map document 1
</PRE>
De même
<PRE>
	get hexadecimal window 1 of map document 1
</PRE>
est équivalent à
<PRE>
	get window of hexadecimal editor 1 of map document 1
</PRE>
Il en va de même si l'on désigne les fenêtres d'édition par nom plutôt 
que par indice:
<PRE>
	get editing window "name_of_window" of map document 1
</PRE>
au lieu de 
<PRE>
	get window of editor "name_of_window" of map document 1
</PRE>
De même
<PRE>
	get template window "name_of_window" of map document 1
</PRE>
est équivalent à
<PRE>
	get window of template editor "name_of_window" of map document 1
</PRE><P><H4><A NAME="M10"></A>Propriétés des tables</H4>
Les tables de ressources sont considérées comme des objets directement
contenus dans l'application. Elles sont caractérisées par un numéro
d'identification unique: c'est un numéro de référence attribué par le
gestionnaire de ressources du système au moment où la table est ouverte.
Par exemple, l'instruction suivante
<PRE>
	get map of map document 1
</PRE>
pourrait renvoyer quelque chose comme ceci:
<P> <I>map id 22 of application "Rezilla"</I>
<P> La table pourrait alors être invoquée par la suite dans un script au moyen de 
l'expression  <I>map id 22</I>. Le numéro d'identification est unique.<P>Les tables de ressources ont les propriétés suivantes:
<UL>
	<LI> <I>refnum</I>: le numéro de référence de la table en mémoire<P>	<LI> <I>all types</I>: la liste de tous les types contenus dans cette 
table (classée par ordre alphabétique)<P>	<LI> <I>attributes</I>: la valeur globale des attributs (valeur 
numérique, somme des drapeaux individuels ci-dessous)<P>	<LI> <I>readOnly</I>: le drapeau <I>ReadOnly</I> de la table (une valeur 
booléenne)<P>	<LI> <I>compact</I>: le drapeau <I>Compact</I> de la table (une valeur 
booléenne)<P>	<LI> <I>changed</I>: le drapeau <I>Changed</I> de la table (une valeur 
booléenne)
</UL><P>Voici un exemple de script pour récupérer les propriétés d'une table de ressources:
<PRE>
	set theMap to the map of map document 1
	set a to the refnum of theMap
	set b to the attributes of theMap
	set c to the readOnly of theMap
	set d to the compact of theMap
	set e to the changed of theMap
	
	{a, b, c, d, e}<P></PRE>
Une table est elle-même un contenant: les objets qu'elle contient sont les 
types, comme nous le verrons à la prochaine section. Pour obtenir la liste de tous les types contenus dans la table, on écrira:
<PRE>
	set theMap to the map of map document 1
	get all types of theMap<P></PRE><P>Les propriétés <I>attributes</I>, <I>readOnly</I>, <I>compact</I> et 
<I>changed</I> peuvent être modifiées au moyen de la commande <B>set</B>. 
Les autres sont des propriétés en lecture seulement. Par exemple:
<PRE>
	set theMap to map document 1
	-- 160 is mapReadOnly _and_ mapChanged (128 + 32)
	set the attributes of theMap to 160
	-- This unsets the mapReadOnly flag (-128)
	set the readOnly of theMap to 0
	-- This sets the mapCompact flag (+64)
	set the compact of theMap to 1
	-- This unsets the mapChanged flag (-32)
	set the changed of theMap to 0<P></PRE><P><H4><A NAME="M11"></A>Propriétés des types</H4>
Un type est un objet contenant des objets <I>ressource</I> . Ses éléments
sont toutes les ressources ayant ce même type. Les types sont des éléments d'un
objet <I>table de ressources</I>: ils peuvent être spécifiés par indice ou
par nom. L'indice d'un type est son indice dans la liste de tous les types
appartenant à la table qui le contient. Le nom est une chaîne de quatre
caractères représentant le type (comme "TEXT", "icns", "MENU", etc.)<P>Les propriétés suivantes sont définies:
<UL>
	<LI> <I>index</I>: l'indice du type dans le document (les types sont 
ordonnés alphabetiquement)<P>	<LI> <I>name</I>: la chaîne de quatre caractères représentant le type<P>	<LI> <I>all IDs</I>: la liste de tous les identificateurs (ID) des 
ressources appartenant à ce type
</UL><P>Voici un exemple de script pour récupérer les propriétés d'un type dans une table de ressources:
<PRE>
	set theType to type "TEXT" of map 1
	set a to the index of theType
	set b to the name of theType
	{a, b}<P></PRE>
Pour obtenir la liste de toutes les ressources appartenant à un type 
particulier, on écrira par exemple:
<PRE>
	set theType to type "TEXT" of map 1
	get all IDs of theType<P></PRE><P>Toutes ces propriétés sont des propriétés en lecture seulement. Elles ne
peuvent être modifiées au moyen de la commande <B>set</B>.<P><H4><A NAME="M12"></A>Propriétés des ressources</H4><P>Une ressource à l'intérieur d'un objet type peut être spécifiée par indice,
par nom ou par identificateur (ID). La spécification par identificateur est
unique. Une ressource peut aussi être désignée directement dans une table
de ressources en utilisant une paire constituée de son type et de son
identificateur,
comme par exemple:
<PRE>
	resource {"TEXT", 128} of map id 22
</PRE><P>On notera qu'il est aussi possible faire référence à une ressource comme 
s'il s'agissait d'un élément d'un document de ressources directement 
plutôt qu'un élément de la table abritée par ce document. Il s'agit d'un
raccourci commode qui permet d'écrire des expressions comme:
<PRE>
	resource {"TEXT", 128} of theDoc
</PRE>
au lieu de
<PRE>
	resource {"TEXT", 128} of the map of theDoc
</PRE><P>Les diverses propriétés d'une ressource sont les suivantes:
<UL>
	<LI> <I>name</I>: le nom de la ressource<P>	<LI> <I>typename</I>: le type de la ressource (sous forme de texte et non 
d'objet)<P>	<LI> <I>ID</I>: l'identificateur (ID) de la ressource<P>	<LI> <I>index</I>: l'indice de la ressource dans le type (dans l'ordre 
utilisé par le gestionnaire de ressources)<P>	<LI> <I>attributes</I>: la valeur globale des attributs de la ressource  
(valeur numérique, somme des drapeaux individuels ci-dessous)<P>	<LI> <I>sysHeap</I>: le drapeau <I>SysHeap</I> de la ressource (une valeur 
booléenne)<P>	<LI> <I>purgeable</I>: le drapeau <I>Purgeable</I> de la ressource (une valeur 
booléenne)<P>	<LI> <I>locked</I>: le drapeau <I>Locked</I> de la ressource (une valeur 
booléenne)<P>	<LI> <I>preload</I>: le drapeau <I>Preload</I> de la ressource (une valeur 
booléenne)<P>	<LI> <I>protected</I>: le drapeau <I>Protected</I> de la ressource (une valeur 
booléenne)<P>	<LI> <I>changed</I>: le drapeau <I>Changed</I> de la ressource (une valeur 
booléenne)<P>	<LI> <I>size</I>: la taille des données de la ressource (en octets)<P>	<LI> <I>sizeOnDisc</I>: la taille de la ressource sur disque<P>	<LI> <I>hex data</I>: les données de la ressource (en format hexadécimal)<P></UL><P>Voici un exemple de script pour récupérer certaines de ces valeurs:
<PRE>
	set therez to resource {"TEXT", 128} of map id 22
	set a to the name of therez
	set b to the ID of therez
	set c to the changed of therez
	set d to the size of therez
	set e to the sizeOnDisc of therez
	set f to the attributes of therez
	set g to the system heap of therez
	set h to the purgeable of therez
	set i to the locked of therez
	set j to the preload of therez
	set k to the protected of therez
	
	{a, b, c, d, e, f, g, h, i, j, k}<P></PRE><P>Les propriétés <I>name</I>, <I>attributes</I>, <I>sysHeap</I>, <I>purgeable</I>, 
<I>locked</I>, <I>preload</I>, <I>protected</I>, <I>changed</I>, <I>sizeOnDisc</I> et <I>hex data</I> peuvent être modifiées au moyen de 
la commande <B>set</B>. 
Les autres sont des propriétés en lecture seulement. Par exemple:
<PRE>
	set theRez to resource {"MENU", 128} of map document 1
	set the name of theRez to "Apple menu"
	-- 12 is resProtected _and_ resPreload (8 + 4):
	set the attributes of theRez to 12
	-- This unsets the resProtected flag:
	set the protected of theRez to 0
	-- This sets the resPurgeable flag:
	set the purgeable of theRez to 1
	-- This unsets the resLocked flag:
	set the locked of theRez to 1
	-- This sets the resChanged flag:
	set the changed of theRez to 1
	-- Modifiy the size on disc (use at your own risk):
	set the sizeOnDisc of theRez to 512<P></PRE><P><H4><A NAME="M13"></A>Contenu d'une ressource</H4><P>Les données de la ressource peuvent être obtenues au moyen de la propriété <I>hex data</I>, 
comme ceci:
<PRE>
	set theRez to resource {"ALRT", 128} of map 1
	get the hex data of theRez<P></PRE>
Le résultat est renvoyé sous forme hexadécimale, comme par exemple: 
<PRE>
	"002800280096019000805555300a"
</PRE><P>La commande <B>set</B> peut être utilisée pour installer des données 
différentes dans la ressource. Par exemple:
<PRE>
	set theRez to resource {"ALRT", 128} of map 1
	set the hex data of therez to "001400140087016800805555300a"<P></PRE><P>On notera deux exceptions importantes concernant la représentation 
hexadécimale des données d'une
ressource. Elles concernent les ressources de type <I>TEXT</I> et les 
ressources de
type <I>STR#</I>. Dans ce cas, Rezilla utilise une représentation textuelle:
<UL>
	<LI> les ressources de type <I>TEXT</I> sont représentées par une chaîne
de texte
	<LI> les ressources de type <I>STR#</I> sont représentées par une liste
AppleScript de chaînes de texte
</UL>
Par exemple, la commande 
<PRE>
	get hex data of resource {"TEXT", 128} of map 1
</PRE>
renverrait <I>Viva Rezilla</I> au lieu de l'équivalent hexadécimal 
566976612052657a696c6c61.<P>La réciproque est vraie. Pour fixer la valeur d'une ressource <I>TEXT</I>
ou <I>STR#</I>, on utilisera la syntaxe suivante:
<PRE>
	-- simple string
	set txtRez to resource {"TEXT", 128} of map 1
	set the hex data of txtRez to "Viva Rezilla!!!"
	-- list of strings
	set strRez to resource {"STR#", 128} of map 1
	set the hex data of strRez to {"Viva Rezilla!!!", "Rezilla is great!!!"}<P></PRE><P><H3><A NAME="M14"></A>Éditer une ressource</H3>
L'édition d'une ressource au moyen d'un éditeur particulier peut être 
accomplie en utilisant la commande <B>edit</B>. Cette commande accepte 
deux arguments optionnels:
<UL>
	<LI> l'argument <B>like</B> permet de spécifier que la ressource devrait
être éditée comme si elle était d'un autre type que son type propre. C'est
l'équivalent de la commande de menu <I>Edit as</I> dans Rezilla.
	<LI> l'argument <B>using</B> permet de spécifier un type particulier
d'éditeur. Les valeurs de ce paramètre peuvent être <I>hexadecimal</I>,
<I>template</I> ou <I>interface</I>. S'il n'existe pas d'éditeur du type
requis, Rezilla utilise son mécanisme habituel de substitution: en dernier
ressort, la ressource sera éditée au moyen de l'éditeur hexadécimal.
</UL><P>Voici quelques exemples:
<PRE>
	edit resource {"MENU", 128} of map 1 using interface<P>	edit resource {"MENU", 128} of map 1 using template<P>	edit resource {"MENU", 128} of map 1 using hexadecimal<P>	edit resource {"aeut", 128} of map 1 as "aete"<P></PRE><P>Les autres actions d'édition de base sont la duplication et la suppression 
d'une ressource dans la 
table de ressources. Elles sont accomplies par les 
commandes <B>duplicate</B> et <B>delete</B> respectivement.
<PRE>
	duplicate resource {"MENU", 128} of map 1<P>	delete resource {"STR#", 128} of map 1<P></PRE><P>La commande <B>delete</B> permet aussi de supprimer toutes les ressources 
d'un certain type simultanément, comme ceci:
<PRE>
delete type "MENU" of map 1<P></PRE><P>Les modifications faites dans un éditeur peuvent être sauvegardées en 
utilisant la commande <B>save</B>:
<PRE>
	save first editor of map document 1<P></PRE>
On notera que les arguments usuels <I>in</I> et <I>as</I> de la commande
<B>save</B> sont ignorés dans ce cas (car elles n'ont pas de sens dans 
ce contexte).<P>Un document d'édition peut être refermé par la commande <B>close</B>, comme ceci:
<PRE>
	close first editor of map document 1<P></PRE>
ou, de manière équivalente, en refermant la fenêtre directement:
<PRE>
	set thewin to window of first editor of map document 1
	close thewin<P></PRE><P>Certains éditeurs (mais malheureusement pas tous) comprennent la commande
<B>revert</B>. Cela concerne l'éditeur de gabarits, l'éditeur de
ressources de terminologie (aete) et l'éditeur de menus. Par exemple:
<PRE>
revert editor "somefile.rsrc - 'MENU' #128" of document 1<P></PRE><P><H3><A NAME="M15"></A>Modifications dans la fenêtre hexadécimale</H3><P>Les fenêtres hexadécimales associées à l'éditeur hexadécimal possèdent 
quelques propriétés qui peuvent servir à modifier le contenu d'une 
ressource directement dans les panneaux de ces fenêtres. Les propriétés 
sont les suivantes:
<UL>
	<LI> <I>maxPos</I>: indice de la dernière position (i-e la position après 
le dernier caractère)<P>	<LI> <I>startPos</I>: position du début de la sélection<P>	<LI> <I>endPos</I>: position de la fin de la selection<P>	<LI> <I>hex selection</I>: contenu de la région sélectionnée dans le 
panneau hexadécimal<P>	<LI> <I>text selection</I>: contenu de la région sélectionnée dans le 
panneau texte<P></UL><P>Voici un exemple de script pour récupérer ces propriétés:
<PRE>
edit resource {"TEXT",128} of map document 1 using hexadecimal
set theWin to hexadecimal window 1 of map document 1
set a to the startPos of theWin
set b to the endPos of theWin
set c to the maxPos of theWin
set d to the hex selection of theWin
set e to the text selection of theWin
{a, b, c, d, e}<P></PRE><P>La propriété <I>maxPos</I> est en lecture seule. Toutes les autres 
propriétés peuvent être modifiées au moyen de la commande <B>set</B>.
Voici un court exemple:
<PRE>
set theWin to hexadecimal window 1 of map document 1
set the startPos of win to 6
set the endPos of win to 9
set the hex selection of win to "52657a696c6c61"<P></PRE><P>Dans cet exemple, les octets situés entre les positions spécifées
seront remplacés par les octets correspondant à la chaîne hexadécimale.
On aurait pu, de manière analogue, effectuer le remplacement dans le panneau 
texte au moyen d'une instruction comme ceci:
<PRE>
	set the text selection of theWin to "Rezilla"
</PRE>
Pour simplement supprimer des octets, il suffit de spécifier une chaîne
vide.<P><H3><A NAME="M16"></A>Créer une nouvelle ressource</H3><P>On peut créer une nouvelle ressource vide dans un document de ressources 
au moyen de la commande <B>make</B>. Cette commande accepte quatre 
paramètres. Les deux premiers sont obligatoires,
les autres sont optionnels:
<UL>
	<LI> le paramètre <I>new</I> indique la classe de l'objet à créer
(en l'occurence <I>resource</I>)
	<LI> le paramètre <I>in</I> est utilisé pour spécifier le document de 
ressources qui contiendra la nouvelle ressource
	<LI> le paramètre <I>with properties</I> est utilisé pour spécifier des
propriétés supplémentaires. C'est une liste de paires de type clé/valeur.
Les clés peuvent être <I>ID</I>, <I>type</I>, <I>name</I>, <I>attributes</I>, <I>locked</I>, <I>preload</I>, <I>protected</I>, <I>purgeable</I> et <I>sysHeap</I>. Ce paramètre est optionnel.
	<LI> le paramètre <I>with data</I> est utilisé pour spécifier un contenu
initial pour la ressource. Il est optionnel. S'il n'est pas présent, la
ressource est créée avec des données vides.
</UL><P>Voici un exemple complet:
<PRE>
	set theDoc to map document 1
	-- create an empty 'MENU' resource
	make new resource in theDoc with properties {type:"MENU"}
	-- create an 'ALRT' resource with ID 128
	make new resource in theDoc with properties ¬
		{ID:128, type:"ALRT", name:"An alert", protected:true} ¬
		with data "001400140087016800805555300a"
	-- create a 'TEXT' resource with the specified string 
	-- ('TEXT' is the default when no type is specified)
	make new resource in theDoc with data "Hello Rezilla"<P></PRE><P>Si aucun identificateur (ID) n'est spécifié, Rezilla attribue un
identificateur unique. Si l'identificateur est spécifié mais qu'il existe
déjà une ressource ayant ce numéro, la création de la nouvelle ressource
échouera: Rezilla préserve ainsi les ressources déjà existantes. Si aucun
type n'est spécifié, Rezilla créera une ressource TEXT par défaut.<P><H3><A NAME="M17"></A>Objets de base et propriétés</H3><P>L'objet racine situé au-dessus de tous les objets de Rezilla est
l'application elle-même. Rezilla définit des propriéts de base pour les
classes document et fenêtre, propriétés dont tous les objets plus
spécifiques (comme les éditeurs ou les fenêtres des tables de ressources
par exemple) héritent à leur tour.<P>Cette section décrit les propriétés des classes <I>application</I>, 
<I>document</I> et <I>window</I>.<P><H4><A NAME="M18"></A>Propriétés de l'application</H4><P>L'application elle-même peut fournir quelques informations. Elle possède 
une propriété <I>version</I> qui renvoie le numéro de version courant. Par exemple:
<PRE>
	get the version<P></PRE><P>La fenêtre d'inspection est aussi une propriété de l'application mais elle
est considérée plutôt comme un objet à part entière. Ses propriétés sont
expliquées dans la section <I>Fenêtre d'inspection</I> ci-dessous.<P><H4><A NAME="M19"></A>Propriétés des documents</H4><P>Rezilla définit les propriétés communes suivantes dont héritent toutes les
classes de documents (documents de ressources, documents d'édition):
<UL>
	<LI> <I>name</I>: le titre du document<P>	<LI> <I>modified</I>: une valeur booléenne indiquant si le document a été
 modifié depuis la dernière sauvegarde
</UL><P>Voici un exemple de script pour récupérer ces propriétés dans le cas de 
différents types de documents:
<PRE>
	set theDoc to map document 1
	set a to the name of theDoc
	set b to the modified of theDoc
	edit resource {"TEXT", 128} of theDoc
	set theEditor to editor 1 of theDoc
	set c to the name of theEditor
	set d to the modified of theEditor
	
	{a, b, c, d}<P></PRE><P>Ce sont des propriétés en lecture seulement. Elles ne peuvent être
modifiées au moyen de la commande <B>set</B>.<P><H4><A NAME="M20"></A>Propriétés des fenêtres</H4><P>Toutes les fenêtres de Rezilla (tables, fenêtres d'édition, fenêtre
d'inspection, etc.) partagent l'ensemble de propriétés suivant:
<UL>
	<LI> <I>name</I>: le titre de la fenêtre<P>	<LI> <I>index</I>: le numéro de la fenêtre<P>	<LI> <I>bounds</I>: les bornes du rectangle de la fenêtre<P>	<LI> <I>closeable</I>: la fenêtre a-t-elle un bouton de fermeture ?<P>	<LI> <I>titled</I>: la fenêtre a-t-elle une barre de titre ?<P>	<LI> <I>floating</I>: la fenêtre est-elle flottante ?<P>	<LI> <I>modal</I>: la fenêtre est-elle modale ?<P>	<LI> <I>resizable</I>: la fenêtre est-elle redimensionnable ?<P>	<LI> <I>zoomable</I>: la fenêtre est-elle réductible (dans le dock) ?<P>	<LI> <I>zoomed</I>: la fenêtre est-elle réduite ?<P>	<LI> <I>visible</I>: la fenêtre est-elle visible?<P>	<LI> <I>position</I>: les coordonnées du coin supérieur gauche de la 
fenêtre<P></UL><P>Voici un exemple de code illustrant ces propriétés:
<PRE>
	set win2 to the second window
	set a to the name of win2
	set b to the bounds of win2
	set c to the position of win2
	set d to the visible of win2
	set e to the closeable of win2
	set f to the titled of win2
	set g to the resizable of win2
	set h to the zoomed of win2
	
	(a, b, c, d, e, f, g, h)<P></PRE><P>Les propriétés <I>name</I>, <I>bounds</I>, <I>zoomed</I>, <I>visible</I>
et <I>position</I> peuvent être modifiées au moyen de la commande 
<B>set</B>. Les autres sont des propriétés en lecture seulement.<P><H3><A NAME="M21"></A>Dénombrement des objets</H3>
La commande <B>count</B> peut être utilisée pour dénombrer plusieurs
sortes d'objets. Voici quelques exemples concernant les fenêtres et les
documents:
<PRE>
	-- windows count
	set a to count windows
	set b to count map windows
	set c to count editing windows
	set d to count hexadecimal windows
	set e to count template windows
	set f to count interface windows
	-- documents count
	set g to count documents
	set h to count map documents
	set i to count editors
	set j to count hexadecimal editors
	set k to count template editors
	set l to count interface editors<P>	{a, b, c, d, e, f, g, h, i, j, k , l}<P></PRE><P>On peut aussi dénombrer les tables, les types et les ressources. Par exemple:
<PRE>
	set a to count maps
	set b to count types of map 1
	set c to count resources of type "TEXT" of map 1<P>	{a, b, c}<P></PRE><P><H3><A NAME="M22"></A>Existence d'objets</H3><P>La commande <B>exists</B> permet de vérifier si un objet est connu de
Rezilla. Voici quelques exemples:
<PRE>
	first window exists
	exists second window
	exists third window
	exists map of document 1
	
	set theMap to map 1
	exists theMap
	exists type "TEXT" of theMap
	exists type "XYZT" of theMap
	
	set theType to type "TEXT" of map 1
	exists resource id 128 of theType
	exists resource "Vivat" of theType
	exists resource id 128 of type "MENU" of map 1
	exists resource {"MENU", 128} of map document 1
	
	exists hexadecimal editor 1
	exists template editor 1
	exists interface editor 1
	
	exists editing window 1
	exists hexadecimal window 1
	exists template window 1
	exists interface window 1
	
	exists window of document 1
	exists editor 1 of document 1
	exists second editor of document 1
	exists window of first editor of document 1
	
	exists inspector<P></PRE><P><H3><A NAME="M23"></A>Fenêtre d'inspection</H3><P>La fenêtre d'inspection est toujours présente dans Rezilla (même si elle
n'est pas affichée, elle reste présente en coulisse). Pour afficher
l'information concernant une ressource particulière, on utilise la commande
<B>inspect</B> comme ceci:
<PRE>
	inspect resource {"MENU", 128} of map 1<P></PRE>
Cette commande affiche la fenêtre d'inspection qui contient toute 
l'information relative à la 
 ressource spécifiée. Chaque champ de la fenêtre d'inspection est 
accessible  grâce aux propriétés de la fenêtre d'inspection:
<UL>
	<LI> <I>ID field</I>: la valeur du champ 'ID' <P>	<LI> <I>name field</I>: la valeur du champ 'Name' <P>	<LI> <I>system heap</I>: la valeur de la case 'System Heap' <P>	<LI> <I>purgeable</I>: la valeur de la case 'Purgeable' <P>	<LI> <I>locked</I>: la valeur de la case 'Locked' <P>	<LI> <I>preload</I>: la valeur de la case 'Preload' <P>	<LI> <I>protected</I>: la valeur de la case 'Protected' <P>	<LI> <I>current resource</I>: la ressource dont  l'information est 
couramment affichée<P></UL>
<PRE>
	set a to the ID field of the inspector
	set b to the name field of the inspector
	set c to the system heap of the inspector
	set d to the purgeable of the inspector
	set e to the locked of the inspector
	set f to the preload of the inspector
	set g to the protected of the inspector
	
	(a, b, c, d, e, f, g)<P></PRE><P>Les champs du numéro d'identification et du nom, de même que toutes les 
cases à cocher peuvent être modifiés au moyen de la commande <B>set data</B> . Par exemple:
<PRE>
	set the name field of inspector to "Viva Rezilla!!!"
	set the ID field of inspector to 130
	set the system heap of inspector to false
	set the purgeable of inspector to true
	set the locked of inspector to true
	set the preload of inspector to false
	set the protected of inspector to true<P></PRE><P>La propriété <I>current resource</I> renvoie une référence à la ressource
affichée par la fenêtre d'inspection ce qui permet d'écrire des
instructions comme :
<PRE>
	get the hex data of the current resource of the inspector
</PRE><P>Il faut cependant distinguer les propriétés réelles d'une ressource de ce
qui peut être affiché dans la fenêtre d'inspection. Si des modifications on
été effectuées dans l'inspecteur, elles ne seront validées dans la
ressource elle-même que lorsque le bouton <I>Apply</I> aura été pressé.
Dans un script AppleScript, on utilisera la commande <B>save</B> afin de
valider le contenu de la fenêtre d'inspection, comme ceci:
<PRE>
	save the inspector
</PRE>
En revanche, si des modifications ont été faites dans la fenêtre
d'inspection et qu'on ne souhaite pas les conserver, on utilisera la
commande <B>revert</B> pour revenir aux dernières valeurs sauvegardées,
comme ceci:
<PRE>
	revert the inspector
</PRE><P>Pour masquer la fenêtre d'inspection, on utilise la commande <B>close</B>:
<PRE>
	close the inspector
</PRE>
De manière équivalente, on peut utiliser l'une des commandes suivantes:
<PRE>
	close inspector window 1
</PRE>
ou
<PRE>
	set the visible of the inspector to false
</PRE>
Pour rendre la fenêtre d'inspection visible, on peut utiliser la commande
<B>inspect</B> comme expliqué précedemment ou invoquer l'instruction
suivante:
<PRE>
	set the visible of the inspector to true
</PRE><P><H3><A NAME="M24"></A>Comparer des tables de ressources</H3><P>On peut effectuer une comparison entre deux tables de ressources (désignées
respectivement, dans ce qui suit, comme l'ancienne et la nouvelle) grâce à
la commande <B>compare</B>. Il faut spécifier en argument les deux
fichiers contenant les tables à comparer. La commande accepte trois
paramètres booléens optionnels permettant de spécifier les critères de
comparison :
<UL>
	<LI> si le paramètre <I>ignoreName</I> a la valeur <I>vrai</I>, les
différences relatives au nom des ressources seront ignorées
	<LI> si le paramètre <I>ignoreAttrs</I> a la valeur <I>vrai</I>, les
différences relatives aux attributs des ressources seront ignorées
	<LI> si le paramètre <I>ignoreData</I> a la valeur <I>vrai</I>, les
différences relatives au contenu des ressources seront ignorées
</UL>
Le comportement par défaut consiste à iGNorer les différences relatives au 
nom et aux attributs.<P>Cette commande renvoie un objet de comparison dont les propriétés indiquent
quelles ressources diffèrent ou sont identiques entre les tables de
ressources. On peut obtenir les propriétés suivantes à partir du résultat:
<UL>
	<LI> <I>old only resources</I>: liste des ressources qui sont seulement 
dans l'ancienne table<P>	<LI> <I>new only resources</I>: liste des ressources qui sont seulement 
dans la nouvelle table<P>	<LI> <I>differing resources</I>: liste des ressources qui existent dans les
deux tables et sont différentes<P>	<LI> <I>identical resources</I>: liste des ressources qui existent dans les
deux tables et sont identiques<P>	<LI> <I>criteria</I>: les critères qui ont été appliqués pour effectuer la
comparison, présentés sous forme d'une liste d'éléments de type clé:valeur 
(par exemple <I>ignoreName:true</I>)<P>	<LI> <I>ignoreName</I>: les différences relatives au nom ont-elles été 
ignorées ?<P>	<LI> <I>ignoreAttrs</I>: les différences relatives aux attributs ont-elles été 
ignorées ?<P>	<LI> <I>ignoreData</I>: les différences relatives au contenu ont-elles été 
ignorées ?<P></UL><P>Voici un exemple complet:
<PRE>
	set theComp to compare "HD:foo:bar:file1" as alias ¬
		and "HD:foo:bar:file2" as alias ¬
		with ignoreName without ignoreAttrs
	-- get information out of the result
	get the old only resources of theComp
	get the new only resources of theComp
	get the differing resources of theComp
	get the identical resources of theComp
	-- get the criteria
	get the criteria of theComp<P></PRE><P><H3><A NAME="M25"></A>Exporter une table de ressources</H3><P>La commande <B>export</B> correspond à l'article de menu <I>Export</I> du
menu Fichier (<I>File</I>) de Rezilla. Elle permet de générer un export
d'une table de ressources dans divers formats. Cette commande accepte deux
paramètres:
<UL>
	<LI> le paramètre <I>in</I> permet de spécifier le dossier dans lequel on 
souhaite créer le fichier d'export. Ce paramètre est obligatoire.
	<LI> le paramètre <I>with properties</I> permet de spécifier le nom du
fichier d'export et le format d'export . Les valeurs possibles pour le
format sont <I>xml</I>, <I>html</I>, <I>text</I> et <I>DeRez</I> (la
valeur par défaut est <I>xml</I>). Si aucun nom n'est fourni, Rezilla
utilise un nom par défaut. Ce paramètre est optionnel.
</UL>
Par exemple:
<PRE>
	export map document 1 in "HD:foo:bar:" as alias ¬
		with properties {name:"exportedMap.xml", format:xml}<P></PRE><P><H3><A NAME="M26"></A>Importer une table de ressources</H3><P>La commande AppleScript <B>import</B> correspond à l'article de menu <I>Import</I> du
menu <I>File</I> de Rezilla. Elle permet d'importer une table de
ressources depuis un fichier XML conforme à la DTD de Rezilla (<I>Rezilla.dtd</I>). C'est le cas des fichiers générés par la commande 
<B>Export</B> en format XML.
Cette commande <B>import</B> accepte deux
paramètres:
<UL>
	<LI> le paramètre direct est une table de ressources ouverte dans Rezilla. 
Cette table doit être vide (comme une table nouvellement 
créée). On ne peut importer dans une table contenant déjà des ressources.<P>	<LI> le paramètre <I>from</I> permet de spécifier le fichier XML à 
importer. Ce paramètre est obligatoire.
</UL>
L'exemple suivant permet de sélectionner un fichier et de l'importer dans 
la première table de ressources:
<PRE>
	set theFile to (choose file)
	import map document 1 from theFile<P></PRE><P><H3><A NAME="M27"></A>Plugins (éditeurs externes)</H3><P>Depuis la version 1.1, Rezilla supporte l'addition d'éditeurs externes
définis au moyen d'extensions (ou <I>plugins</I>). La terminologie
<I>AppleScript</I> comporte un nouveau terme <I>plugin</I> permettant d'obtenir 
des informations sur les extensions couramment disponibles.<P>Les objets <I>plugin</I> appartiennent directement à l'objet application.
On peut les désigner par nom ou par indice. Voici quelques instructions
AppleScript simples:
<UL>
	<LI> pour obtenir la liste des plugins
<PRE>
	get name of plugins<P></PRE>
	<LI> pour dénombrer les plugins
<PRE>
	count plugins<P></PRE>
</UL><P>Les objets <I>plugin</I> possèdent les propriétés suivantes:
<UL>
	<LI> <I>name</I>: le nom du plugin. C'est le nom du plugin 
comme fichier, comme par exemple <I>RezImagePlugin.plugin</I>.<P>	<LI> <I>index</I>: l'indice du plugin<P>	<LI> <I>version</I>: le numéro de version courant du plugin<P>	<LI> <I>typecode</I>: le code de type du plugin<P>	<LI> <I>creator</I>: le code de créateur du plugin<P>	<LI> <I>loaded</I>: indique si le plugin est déjà chargé par Rezilla. Les 
plugins sont chargés de façon paresseuse, autrement dit seulement lorsque 
l'utilisateur demande l'édition d'une ressource au moyen d'un plugin.<P>	<LI> <I>supported types</I>: la liste de tous les types de ressources qui 
peuvent être édités par le plugin<P></UL><P>Toutes ces propriétés sont en lecture seule: elles ne peuvent être 
modifiées au moyen de la commande <B>set</B>. Voici quelques instructions 
simples pour obtenir les informations sur un plugin:
<PRE>
	set a to name of plugin 1
	set b to version of plugin 1
	set c to typecode of plugin 1
	set d to creator of plugin 1
	set e to loaded of plugin 1
	{a, b, c, d, e}<P></PRE>
Pour obtenir la liste des types supportés:
<PRE>
	get supported types of plugin "RezImagePlugin.plugin"	<P></PRE><P>Dans le cas où plusieurs plugins supportent un même type de ressource,
Rezilla permet de spécifier le plugin à utiliser de préférence pour éditer
une ressource de ce type. Ce choix peut être réglé dans l'application dans
le panneau <I>Plugin Order</I> du dialogue affiché lorsqu'on invoque la
commande <I>Plugins...</I> du menu <I>File</I>. On peut aussi le
contrôler par une instruction AppleScript. Il y a une propriété de
l'application appelée <I>preferred plugins</I> à cet effet: elle renvoie
un dictionnaire dont les clés sont les types de ressources et les valeurs
sont, pour chaque type, le nom du plugin préféré associé. Par exemple, 
le script suivant:
<PRE>
	get preferred plugins<P></PRE>
renvoie des informations telles que
<PRE>
    {JPEG:"RezImagePlugin.plugin", PStr:"RezSamplePlugin.plugin", etc.}
</PRE><P>Cette propriété peut être modifiée avec la commande <B>set</B> afin de
désigner un autre plugin de prédilection pour certains types (le réglage ne
se fait pas nécessairement pour tous les types à la fois). Ceci n'a de sens que
pour les types supportés par plusieurs plugins. Par exemple:
<PRE>
	-- Assume the 'jpg ' and 'tiff' resource types can be edited by several
	-- plugins and you want Rezilla to use the RezImagePlugin plugin for them
	set preferred plugin to {«class tiff»:"RezImagePlugin.plugin", «class jpg »:"RezImagePlugin.plugin"}<P></PRE>
Le plugin doit par ailleurs exister effectivement pour que cette opération
réussisse.<P><H3><A NAME="M28"></A>Sélectionneurs de ressources</H3><P>Les sélectionneurs de ressources (<I>resource pickers</I>, introduits dans
la version 1.1) ont les propriétés suivantes:
<UL>
	<LI> <I>name</I>: le nom du sélectionneur. C'est le nom (sous forme de 
chaîne) du type associé et non pas le titre de la fenêtre de sélection.
  
	<LI> <I>index</I>: l'indice du sélectionneur
  
	<LI> <I>readOnly</I>: valeur booléenne qui indique si le sélectionneur est en lecture seule
  
	<LI> <I>window</I>: la fenêtre du sélectionneur
  
	<LI> <I>type</I>: le type des ressources affichées par le sélectionneur
  
	<LI> <I>owner doc</I>: le document auquel le sélectionneur appartient
  
	<LI> <I>selection</I>: le numéro de la ressource couramment sélectionnée 
(ou une chaîne vide si aucune ressource n'est sélectionnée)
  
</UL><P>Les sélectionneurs, en tant qu'objets, sont des éléments appartenant aux
tables de ressources (<I>map document</I>). Ils peuvent être désignés par
type (c'est le type qui tient lieu de nom) ou par indice. Par exemple, on
peut écrire:
<PRE>
    set thePik to picker "icl8" of map document 1
</PRE><P>Le script suivant permet de récupérer toutes les valeurs des propriétés 
d'un sélectionneur:
<PRE>
	set thePik to picker 1 of map document 1
	set a to the name of thePik
	set b to the index of thePik
	set c to the readOnly of thePik
	set d to the window of thePik
	set e to the type of thePik
	set f to the owner doc of thePik
	set g to the selection of thePik<P>	{a, b, c, d, e, f, g}<P></PRE><P>Seule la propriété <I>selection</I> peut être modifiée au moyen de la 
commande <B>set</B>. Toutes les autres sont en lecture seule. Le numéro de 
la ressource à sélectionner doit être passé sous forme de chaîne. Par 
exemple:
<PRE>
    set the selection of picker 1 of map document 1 to "128"
</PRE>
Pour retirer la sélection, il suffit de passer une chaîne vide dans la 
propriété <I>selection</I>, comme ceci:
<PRE>
    set the selection of picker 1 of map document 1 to ""
</PRE><P>Un sélectionneur peut être ouvert au moyen de la commande <B>pick</B> 
comme ceci:
<PRE>
	pick type "cicn" of map 1<P></PRE>
Si un sélectionneur est effectivement défini pour le type spécifié, la 
commande renvoie un spécificateur pour l'objet nouvellement créé.<P>Pour refermer un sélectionneur, on utilise la commande <B>close</B> comme 
ceci:
<PRE>
	close picker "cicn" of map document 1<P></PRE><P><B>Caveat:</B> la commande <I>pick</I> s'applique aux types (objets <I>type</I>), qui sont des éléments des objets <I>map</I> (tables de
ressources) et non pas des objets <I>map document</I>. D'un autre côté,
les sélectionneurs sont des éléments d'un objet <I>map document</I> et non
pas d'un objet <I>map</I>. On doit donc faire scrupuleusement la
distinction entre <I>map</I> et <I>map document</I>, comme dans le code
suivant:
<PRE>
	pick type "TEXT" of map 1
	count pickers of map document 1
	close picker "TEXT" of map document 1
</PRE><P><H2><A NAME="M29"></A>Le dictionnaire de Rezilla </H2><P>Voici, pour la référence, la description formelle complète du dictionnaire
de terminologie de Rezilla, telle que la rapporte (en anglais) 
l'application <I>Éditeur de Scripts</I>.<P><PRE>
Required Suite: Terms that every application should support<P>open: Open the specified object(s)
	open  reference  -- Objects to open. Can be a list of files or an object specifier.
		[from  data fork/resource fork/any fork/same fork]  -- restrict to a particular fork (default is anyFork)
		[readOnly  boolean]  -- specify if the file should be opened in read-only mode (by default it is not)
		[createFork  boolean]  -- specify if a resource fork should be created when the file does not have any resource fork already (by default it is not)<P>quit: Quit the application
	quit<P>Standard Suite: Common terms for most applications<P>Class application: the application
Elements:
	window by numeric index, by name, as a range of elements
	document by numeric index, by name
	map document by numeric index, by name
	map by ID
	plugin by numeric index, by name
Properties:
	name  international text  [r/o]  -- Rezilla's name
	version  international text  [r/o]  -- the version of the application
	inspector  inspector window  [r/o]  -- the inspector
	preferred plugin  record  -- the preferred plugin for each supported type: the property is a record whose keys are the types and the values are the plugin names.<P>Class document: A document
Plural form:
	documents
Properties:
	name  international text  [r/o]  -- the title of the document
	modified  boolean  [r/o]  -- Has the document been modified since the last save?<P>Class window: a window
Plural form:
	windows
Properties:
	name  international text  -- the title of the window
	index  integer  [r/o]  -- the number of the window
	bounds  bounding rectangle  -- the boundary rectangle for the window
	closeable  boolean  [r/o]  -- does the window have a close box?
	titled  boolean  [r/o]  -- does the window have a title bar?
	floating  boolean  [r/o]  -- does the window float?
	modal  boolean  [r/o]  -- is the window modal?
	resizable  boolean  [r/o]  -- is the window resizable?
	zoomable  boolean  [r/o]  -- is the window zoomable?
	zoomed  boolean  -- is the window zoomed?
	visible  boolean  -- is the window visible?
	position  point  -- upper left coordinates of window<P>close: Close an object
	close  reference  -- the objects to close
		[saving  yes/no/ask]  -- specifies whether or not changes should be saved before closing<P>count: Return the number of elements of a particular class within an object
	count  reference  -- the object whose elements are to be counted
		each  type class  -- the class of the elements to be counted
	Result:   integer  -- the number of elements<P>data size: Return the size in bytes of an object
	data size  reference  -- the object whose data size is to be returned
	Result:   integer  -- the size of the object in bytes<P>exists: Verify if an object exists
	exists
	Result:   boolean  -- true if it exists, false if not<P>get: Get the data for an object
	get  reference  -- the object whose data is to be returned
	Result:   anything  -- The data from the object<P>make: Make a new element
	make
		new  type class  -- the class of the new element
		in  reference  -- the container in which to create the new element (it must already exist)
		[with properties  record]  -- properties of the element (for instance 'name', 'readOnly', 'fork')
		[with data  anything]  -- the initial data for the new element
	Result:   reference  -- Object specifier for the new element<P>revert: Revert an object to the most recently saved version
	revert  reference  -- object to revert<P>save: save an object
	save  reference  -- object to save
		[in  alias]  -- the file in which to save the object
		[as  data fork/resource fork/any fork/same fork]  -- the fork in which to save the data (in a Save As operation)<P>set: Set an object's data
	set  reference  -- the object to change
		to  anything  -- the new value<P>Rezilla suite: Rezilla specifics<P>Class comparison window: a maps comparison window
Plural form:
	comparison windows
Properties:
	inherits  window  [r/o]  -- all properties of the 'window' class
	result  comparison  [r/o]  -- a comparison result object<P>Class editing window: a resource editing window (hexadecimal, template or interface)
Plural form:
	editing windows
Properties:
	inherits  window  [r/o]  -- all properties of the 'window' class
	kind  interface/plugin/template/hexadecimal  [r/o]  -- the kind of the editing window (hexadecimal, template, plugin or interface)<P>Class editor: an editor document for a single resource
Plural form:
	editors
Properties:
	inherits  document  [r/o]  -- all properties of the 'document' class
	index  integer  [r/o]  -- the number of the document
	kind  interface/plugin/template/hexadecimal  [r/o]  -- the kind of editor document (hexadecimal, template, plugin or interface)
	readOnly  boolean  [r/o]  -- is this document read-only?
	window  window  [r/o]  -- the window of the document.
	resource  resource  [r/o]  -- the resource edited by this document
	owner doc  map document  [r/o]  -- the rezmap document that owns this editor document<P>Class hexadecimal editor: a hexadecimal document editing a resource
Plural form:
	hexadecimal editors
Properties:
	inherits  editor  [r/o]  -- all properties of the 'editor' class<P>Class hexadecimal window: a hexadecimal editing window
Plural form:
	hexadecimal windows
Properties:
	inherits  editing window  [r/o]  -- all properties of the 'editing window' class
	maxPos  integer  [r/o]  -- index of last position (i-e position after the last character)
	startPos  integer  -- position of beginning of selection
	endPos  integer  -- position of end of selection
	hex selection  international text  -- the contents of the selected region in the hex pane
	text selection  international text  -- the contents of the selected region in the text pane<P>Class inspector window: the inspector window
Properties:
	inherits  window  [r/o]  -- all properties of the 'window' class
	ID field  small integer  -- the value of the 'ID' field
	name field  international text  -- the value of the 'name' field
	system heap  boolean  -- the value of the 'System Heap' checkbox
	purgeable  boolean  -- the value of the 'Purgeable' checkbox
	locked  boolean  -- the value of the 'Locked' checkbox
	preload  boolean  -- the value of the 'Preload' checkbox
	protected  boolean  -- the value of the 'Protected' checkbox
	current resource  resource  [r/o]  -- the resource for which info is currently displayed<P>Class interface editor: a dedicated interface document editing a resource
Plural form:
	interface editors
Properties:
	inherits  editor  [r/o]  -- all properties of the 'editor' class<P>Class interface window: an interface editing window
Plural form:
	interface windows
Properties:
	inherits  editing window  [r/o]  -- all properties of the 'editing window' class<P>Class map document: a resource map document (representing the contents of an entire fork)
Plural form:
	map documents
Elements:
	editor by numeric index, by name
	picker by numeric index, by name
Properties:
	inherits  document  [r/o]  -- all properties of the 'document' class
	index  integer  [r/o]  -- the number of the document among other map documents
	readOnly  boolean  [r/o]  -- is this document read-only?
	window  window  [r/o]  -- the window of the document.
	refnum  small integer  [r/o]  -- the reference number of the map in memory
	fork  DataFork/ResourceFork/UnknownFork  [r/o]  -- the fork this document is editing (data fork or resource fork)
	map  map  [r/o]  -- the resource map associated with this document
	file  file specification  [r/o]  -- the file on disk corresponding to this resource map document
	format  unknown export/xml/html/text/DeRez  -- the format used for export<P>Class map window: a resource map window
Plural form:
	map windows
Properties:
	inherits  window  [r/o]  -- all properties of the 'window' class
	types count  integer  [r/o]  -- number of types in this map as displayed at the bottom of the map window
	resources count  integer  [r/o]  -- total number of resources in this map as displayed at the bottom of the map window<P>Class picker: a picker document for a given type
Plural form:
	pickers
Properties:
	name  international text  [r/o]  -- the name of the picker: this is the name of the associated type
	index  integer  [r/o]  -- the index of the picker
	readOnly  boolean  [r/o]  -- is this picker read-only?
	window  window  [r/o]  -- the window of the picker
	type  type  [r/o]  -- the type of the resources displayed by this picker
	owner doc  map document  [r/o]  -- the rezmap document that owns this picker
	selection  international text  -- the ID of the selected resource (use an empty string to remove the selection)<P>Class picker window: a picker window
Plural form:
	picker windows
Properties:
	inherits  window  [r/o]  -- all properties of the window class<P>Class plugin: a plugin object
Plural form:
	plugins
Properties:
	name  international text  [r/o]  -- the name of the plugin
	index  integer  [r/o]  -- the index of the plugin
	version  international text  [r/o]  -- the version of the plugin
	typecode  string  [r/o]  -- the type code of the plugin
	creator  string  [r/o]  -- the creator code of the plugin
	loaded  boolean  [r/o]  -- is the plugin loaded?
	supported types  a list of list  [r/o]  -- the list of types supported by the plugin<P>Class plugin editor: a plugin document editing a resource
Plural form:
	plugin editors
Properties:
	inherits  editor  [r/o]  -- all properties of the 'editor' class<P>Class plugin window: a plugin editing window
Plural form:
	plugin windows
Properties:
	inherits  editing window  [r/o]  -- all properties of the 'editing window' class<P>Class template editor: a template document editing a resource
Plural form:
	template editors
Properties:
	inherits  editor  [r/o]  -- all properties of the 'editor' class<P>Class template window: a template editing window
Plural form:
	template windows
Properties:
	inherits  editing window  [r/o]  -- all properties of the 'editing window' class<P>compare: compare two resource maps
	compare  alias  -- first resource file for comparison
		and  alias  -- second resource file for comparison
		[ignoreName  boolean]  -- ignore name differences
		[ignoreAttrs  boolean]  -- ignore attributes differences
		[ignoreData  boolean]  -- ignore data differences
	Result:   comparison  -- a maps comparison object<P>delete: Delete the specified object
	delete  reference  -- the object to delete<P>duplicate: Duplicate a resource in the resource map. The duplicate is automatically attributed an unique ID.
	duplicate  reference  -- the object to duplicate
	Result:   reference  -- a specifier for the duplicated resource(s)<P>edit: edit one or more resources
	edit  resource  -- resource to edit
		[using  interface/plugin/template/hexadecimal]  -- specifies which kind of editor to use (if not specified, Rezilla tries to find successively an interface, a template or the hexadecimal editor)
		[like  type class]  -- use an another type's editor<P>export: export a rezmap document in a specified format
	export  map document  -- resource map document to export
		in  alias  -- the folder in which to save the export file. This folder must already exist.
		[with properties  record]  -- the initial values for the properties (essentially to specify a name and a format)<P>import: import a rezmap document from an XML file
	import  map document  -- the map document into which to import the data. This must be an empty document.
		from  alias  -- the XML file to import. It must be conform to the Rezilla DTD.<P>inspect: display info about the specified resource in the Inspector window
	inspect  resource  -- Resource object to display info about.<P>pick: open a picker
	pick  type  -- type of the resources to display in a picker
	[Result:   picker]  -- an object specifier for the picker<P>Resource suite: Resource maps handling<P>Class comparison: the result of a comparison between two maps
Properties:
	criteria  record  [r/o]  -- the comparison criteria
	ignoreName  boolean  [r/o]  -- have name differences been ignored?
	ignoreAttrs  boolean  [r/o]  -- have attributes differences been ignored?
	ignoreData  boolean  [r/o]  -- have data differences been ignored?
	old only resources  a list of list  [r/o]  -- the list of resources which are only in the old map
	new only resources  a list of list  [r/o]  -- the list of resources which are only in the new map
	differing resources  a list of list  [r/o]  -- the list of resources which exist in both maps and are different
	identical resources  a list of list  [r/o]  -- the list of resources which exist in both maps and are identical<P>Class map: a resource map
Plural form:
	maps
Elements:
	type by numeric index, by name, by ID
Properties:
	refnum  small integer  [r/o]  -- the reference number of the map in memory
	all types  list  [r/o]  -- the list of all types (in alphabetical order)
	attributes  small integer  -- the global value of the map attributes (sum of the individual flags)
	readOnly  boolean  -- the mapReadOnly bit
	compact  boolean  -- the mapCompact bit
	changed  boolean  -- the mapChanged bit<P>Class resource: a single resource with specific type and ID
Plural form:
	resources
Properties:
	name  international text  -- the resource's name
	typename  string  [r/o]  -- the type of the resource as text
	ID  small integer  [r/o]  -- the ID of the resource
	index  integer  [r/o]  -- the index of the resource within its type (in the order used by the resource manager)
	attributes  small integer  -- the global value of the resource attributes (sum of the individual flags)
	sysHeap  boolean  -- the resSysHeap bit
	purgeable  boolean  -- the resPurgeable bit
	locked  boolean  -- the resLocked bit
	preload  boolean  -- the resPreload bit
	protected  boolean  -- the resProtected bit
	changed  boolean  -- the resChanged bit
	size  integer  [r/o]  -- the size of the resource data (in bytes)
	sizeOnDisc  integer  [r/o]  -- the size of the resource on disk
	hex data  anything  -- the resource data (in hex format)<P>Class specifier: a two-elements list containing the type and the ID of a resource<P>Class type: a resource type
Plural form:
	types
Elements:
	resource by name, by ID, by numeric index
Properties:
	index  integer  [r/o]  -- the index of the type in the document (types are ordered alphabetically)
	name  international text  [r/o]  -- the type's name
	ID  unsigned integer  [r/o]  -- a type as a long unsigned integer
	all IDs  list  [r/o]  -- the list of all IDs of resources belonging to this type<P></PRE><P><!--  logo SF -->
<!--  ------- -->
<HR>
<P> Last updated 2006-11-01 15:24:42
<HR>
<P> <I>Rezilla is hosted by</I> 
<A HREF="http://sourceforge.net"> <P><IMG SRC="http://sourceforge.net/sflogo.php?group_id=83267&amp;type=4 " ALT="SourceForge.net Logo" ALIGN=bottom></P></A><P>
</BODY>
</HTML>